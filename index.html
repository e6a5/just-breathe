<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Just Breathe</title>
  <meta name="description" content="Simple breathing companion app">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='35' fill='blue'/></svg>">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      color: white;
      margin: 0;
      padding: 1rem;
      box-sizing: border-box;
    }
    
    h1 {
      font-size: 2.5rem;
      font-weight: 300;
      margin-bottom: 1rem;
      text-shadow: 0 2px 4px rgba(0,0,0,.3);
    }
    
    p {
      font-size: 1.1rem;
      opacity: .9;
      margin-bottom: 2rem;
      font-weight: 300;
    }
    
    #breathing-circle {
      display: block;
      margin: 2rem auto;
      width: 600px;
      height: 600px;
      max-width: 100%;
      border-radius: 50%;
      overflow: hidden;
    }
    
    @media (max-width: 768px) {
      h1 { font-size: 2rem; }
      #breathing-circle { width: 500px; height: 500px; }
    }
    
    @media (max-width: 480px) {
      h1 { font-size: 1.5rem; }
      #breathing-circle { width: 400px; height: 400px; }
    }
  </style>
</head>
<body>
  <h1>Just Breathe</h1>
  <p>Find your calm through simple breathing</p>
  <canvas id="breathing-circle" width="600" height="600"></canvas>
  
  <!-- Fallback if canvas fails -->
  <div id="fallback" style="display: none; text-align: center;">
    <div style="width: 200px; height: 200px; border: 3px solid white; border-radius: 50%; margin: 2rem auto; display: flex; align-items: center; justify-content: center;">
      <span style="font-size: 1.2rem; opacity: 0.8;">Breathe</span>
    </div>
    <p style="font-size: 1.1rem; opacity: 0.9;">Follow the rhythm: Inhale... Hold... Exhale...</p>
  </div>
  
  <script>
    class BreathingApp {
      constructor() {
        // Get canvas and context
        this.canvas = document.getElementById('breathing-circle');
        this.ctx = this.canvas.getContext('2d');
        
        // Check if canvas is supported
        if (!this.ctx) {
          this.showFallback();
          return;
        }
        
        // Canvas dimensions
        this.width = this.canvas.width;
        this.height = this.canvas.height;
        this.centerX = this.width / 2;
        this.centerY = this.height / 2;
        
        // Animation settings
        this.duration = 8000; // 8 seconds per breath cycle
        this.startTime = performance.now();
        this.radius = 60;
        
        // Performance optimizations
        this.ctx.imageSmoothingEnabled = false;
        this.canvas.style.willChange = 'transform';
        
        // Bind methods and start animation
        this.animate = this.animate.bind(this);
        this.animate();
      }
      
      // Show fallback if canvas fails
      showFallback() {
        this.canvas.style.display = 'none';
        document.getElementById('fallback').style.display = 'block';
      }
      
      // Main animation loop
      animate() {
        const progress = (performance.now() - this.startTime) % this.duration / this.duration;
        this.radius = this.calculateRadius(progress);
        this.drawBreathingCircle();
        requestAnimationFrame(this.animate);
      }
      
      // Calculate radius based on breathing cycle
      calculateRadius(time) {
        const minRadius = 80;
        const maxRadius = 120;
        
        if (time < 0.25) {
          // Inhale: expand
          return Math.round(minRadius + maxRadius * time * 4);
        } else if (time < 0.5) {
          // Hold: full size
          return minRadius + maxRadius;
        } else if (time < 0.75) {
          // Exhale: contract
          return Math.round(minRadius + maxRadius - maxRadius * (time - 0.5) * 4);
        } else {
          // Hold: small size
          return minRadius;
        }
      }
      
      // Draw the breathing circle with multiple layers
      drawBreathingCircle() {
        this.ctx.clearRect(0, 0, this.width, this.height);
        
        const centerX = Math.round(this.centerX);
        const centerY = Math.round(this.centerY);
        const radius = Math.round(this.radius);
        
        this.ctx.save();
        
        // Outer ring (most transparent)
        this.ctx.globalAlpha = 0.1;
        this.ctx.beginPath();
        this.ctx.arc(centerX, centerY, radius * 1.8, 0, 2 * Math.PI);
        this.ctx.fillStyle = 'rgba(255,255,255,1)';
        this.ctx.fill();
        
        // Second ring
        this.ctx.globalAlpha = 0.2;
        this.ctx.beginPath();
        this.ctx.arc(centerX, centerY, radius * 1.4, 0, 2 * Math.PI);
        this.ctx.fillStyle = 'rgba(255,255,255,1)';
        this.ctx.fill();
        
        // Third ring
        this.ctx.globalAlpha = 0.4;
        this.ctx.beginPath();
        this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        this.ctx.fillStyle = 'rgba(255,255,255,1)';
        this.ctx.fill();
        
        // Inner ring (most opaque)
        this.ctx.globalAlpha = 0.7;
        this.ctx.beginPath();
        this.ctx.arc(centerX, centerY, radius * 0.6, 0, 2 * Math.PI);
        this.ctx.fillStyle = 'rgba(255,255,255,1)';
        this.ctx.fill();
        
        this.ctx.restore();
      }
    }
    
    // Initialize the app
    new BreathingApp();
  </script>
</body>
</html>
